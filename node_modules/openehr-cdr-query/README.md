# openehr-cdr-query

[![Build Status](https://travis-ci.org/ucl-openehr-explorer/openehr-cdr-query.svg?branch=master)](https://travis-ci.org/ucl-openehr-explorer/openehr-cdr-query)

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [CDR](#cdr)
    -   [Parameters](#parameters)
    -   [query](#query)
        -   [Parameters](#parameters-1)
-   [CDRError](#cdrerror)
    -   [Parameters](#parameters-2)
    -   [Properties](#properties)

### CDR

A connection to a single Clinical Data Repository

#### Parameters

-   `config` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** CDR configuration
    -   `config.url` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** API URL (without a trailing /)
    -   `config.authentication` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Authentication configuration
        -   `config.authentication.type` **`"basic"`** Type of authentication (currently only supports Basic)
        -   `config.authentication.username` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Username for authentication
        -   `config.authentication.password` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Password for authentication

#### query

Runs an AQL query against the CDR

##### Parameters

-   `aql` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The AQL query to run

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)>** A promise resolving with the parsed JSON result of the query from the CDR, or rejecting with a [CDRError](#cdrerror)

### CDRError

**Extends Error**

Represents an error when communicating with a Clinical Data Repository

#### Parameters

-   `res` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** node-fetch response object

#### Properties

-   `message` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Status code and text returned by CDR
-   `body` **([Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object) \| [String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String))** Error body returned by CDR: either parsed JSON or a HTML string
